<!DOCTYPE html>
<html>
<head>
    <title></title>
	
  <link rel="icon"  type="image/png"  href="https://stassociation.com/img/favicon.ico">
   <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">

  <script src="js/jquery.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
    <script type="text/javascript">
       //app.initialize();
    </script>
  <script src="http://maps.googleapis.com/maps/api/js?libraries=places,geometry&amp;language=en&amp;key=AIzaSyCGWPy8EXdIZF6fIGX5IsMlrv2y-pT1BZY" ></script>

  <script src="js/main.js"></script>
  <script src="js/sta.js"></script>

<script>

    (function(window){
        formData = new FormData($('form')[0]);

        var WORKER_PATH = '../js/recorderWorker.js';

        var Recorder = function(source, cfg){
            var config = cfg || {};
            var bufferLen = config.bufferLen || 4096;
            this.context = source.context;
            if(!this.context.createScriptProcessor){
                this.node = this.context.createJavaScriptNode(bufferLen, 2, 2);
            } else {
                this.node = this.context.createScriptProcessor(bufferLen, 2, 2);
            }

            var worker = new Worker(config.workerPath || WORKER_PATH);
            worker.postMessage({
                command: 'init',
                config: {
                    sampleRate: this.context.sampleRate
                }
            });
            var recording = false,
                currCallback;

            this.node.onaudioprocess = function(e){
                if (!recording) return;
                worker.postMessage({
                    command: 'record',
                    buffer: [
                        e.inputBuffer.getChannelData(0),
                        e.inputBuffer.getChannelData(1)
                    ]
                });
            }

            this.configure = function(cfg){
                for (var prop in cfg){
                    if (cfg.hasOwnProperty(prop)){
                        config[prop] = cfg[prop];
                    }
                }
            }

            this.record = function(){
                recording = true;
            }

            this.stop = function(){
                recording = false;
            }

            this.clear = function(){
                worker.postMessage({ command: 'clear' });
            }

            this.getBuffers = function(cb) {
                currCallback = cb || config.callback;
                worker.postMessage({ command: 'getBuffers' })
            }

            this.exportWAV = function(cb, type){
                currCallback = cb || config.callback;
                type = type || config.type || 'audio/wav';
                if (!currCallback) throw new Error('Callback not set');
                worker.postMessage({
                    command: 'exportWAV',
                    type: type
                });
            }

            this.exportMonoWAV = function(cb, type){
                currCallback = cb || config.callback;
                type = type || config.type || 'audio/wav';
                if (!currCallback) throw new Error('Callback not set');
                worker.postMessage({
                    command: 'exportMonoWAV',
                    type: type
                });
            }

            worker.onmessage = function(e){
                var blob = e.data;
                currCallback(blob);
            }

            source.connect(this.node);
            this.node.connect(this.context.destination);   // if the script node is not connected to an output the "onaudioprocess" event is not triggered in chrome.
        };

        Recorder.setupDownload = function(blob, filename){
            var url = (window.URL || window.webkitURL).createObjectURL(blob);
            var link = document.getElementById("save");


            formData.append("recording",blob,filename);
            console.log(formData);
            console.log(formData.recording);
            $.ajax({
                url:'/logistic/upload_app',
                type: 'POST',
                data: formData,
                processData: false,
                contentType: false

            });

            link.href = url;
            $('#recordedAudio').attr('src',url);

            link.download = filename || 'output.wav';
        }

        window.Recorder = Recorder;

    })(window);

    window.AudioContext = window.AudioContext || window.webkitAudioContext;

    var audioContext = new AudioContext();
    var audioInput = null,
        realAudioInput = null,
        inputPoint = null,
        audioRecorder = null;
    var rafID = null;
    var analyserContext = null;
    var canvasWidth, canvasHeight;
    var recIndex = 0;

    /* TODO:

     - offer mono option
     - "Monitor input" switch
     */

    function saveAudio() {
        audioRecorder.exportWAV( doneEncoding );
        // could get mono instead by saying
        // audioRecorder.exportMonoWAV( doneEncoding );
    }

    function gotBuffers( buffers ) {


        // the ONLY time gotBuffers is called is right after a new recording is completed -
        // so here's where we should set up the download.
        audioRecorder.exportWAV( doneEncoding );
    }

    function doneEncoding( blob ) {
        Recorder.setupDownload( blob, "myRecording" + ((recIndex<10)?"0":"") + recIndex + ".wav" );
        recIndex++;
    }

    function toggleRecording( e ) {
        if (e.classList.contains("recording")) {
            // stop recording
            audioRecorder.stop();
            e.classList.remove("recording");
            audioRecorder.getBuffers( gotBuffers );

        } else {
            // start recording
            if (!audioRecorder)
                return;
            e.classList.add("recording");
            audioRecorder.clear();
            audioRecorder.record();

        }
    }

    function convertToMono( input ) {
        var splitter = audioContext.createChannelSplitter(2);
        var merger = audioContext.createChannelMerger(2);

        input.connect( splitter );
        splitter.connect( merger, 0, 0 );
        splitter.connect( merger, 0, 1 );
        return merger;
    }

    function cancelAnalyserUpdates() {
        window.cancelAnimationFrame( rafID );
        rafID = null;
    }


    function toggleMono() {
        if (audioInput != realAudioInput) {
            audioInput.disconnect();
            realAudioInput.disconnect();
            audioInput = realAudioInput;
        } else {
            realAudioInput.disconnect();
            audioInput = convertToMono( realAudioInput );
        }

        audioInput.connect(inputPoint);
    }

    function gotStream(stream) {
        inputPoint = audioContext.createGain();
        realAudioInput = audioContext.createMediaStreamSource(stream);
        audioInput = realAudioInput;
        audioInput.connect(inputPoint);


        analyserNode = audioContext.createAnalyser();
        analyserNode.fftSize = 2048;
        inputPoint.connect( analyserNode );

        audioRecorder = new Recorder( inputPoint );

        zeroGain = audioContext.createGain();
        zeroGain.gain.value = 0.0;
        inputPoint.connect( zeroGain );
        zeroGain.connect( audioContext.destination );


    }

    function initAudio() {
        if (!navigator.getUserMedia)
            navigator.getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia;
        if (!navigator.cancelAnimationFrame)
            navigator.cancelAnimationFrame = navigator.webkitCancelAnimationFrame || navigator.mozCancelAnimationFrame;
        if (!navigator.requestAnimationFrame)
            navigator.requestAnimationFrame = navigator.webkitRequestAnimationFrame || navigator.mozRequestAnimationFrame;

        navigator.getUserMedia(
            {
                "audio": {
                    "mandatory": {
                        "googEchoCancellation": "false",
                        "googAutoGainControl": "false",
                        "googNoiseSuppression": "false",
                        "googHighpassFilter": "false"
                    },
                    "optional": []
                }
            }, gotStream, function(e) {
                alert('Error getting audio');
                console.log(e);
            });
    }

    $('#send_form').on('click',initAudio());
</script>
	</head>
	<body>
    <form></form>
  <div id="markers_script"></div>
  <div id="markers_dist_script"></div>

 <div class="left_menu col-md-4  col-sm-6 col-xs-12 pad0">
   <h1><i class="fa fa-list" aria-hidden="true"></i> Menu</h1>
   <div class="menu_overflow">

    <div data-id="login" class="col-md-12 menu-item"><i class="fa fa-check" aria-hidden="true"></i> Status</div>    

    <div  data-id="radio" class="col-md-12 menu-item"><i class="fa fa-music" aria-hidden="true"></i> Radio</div>
    
    <a target="_system" href="https://stassociation.com/user/"  class="col-md-12 menu-item">
      <i class="fa fa-external-link-square" aria-hidden="true"></i> My profile
    </a>
    <a target="_system" href="https://stassociation.com/st/about_us/"  class="col-md-12 menu-item">
      <i class="fa fa-external-link-square" aria-hidden="true"></i> About us
    </a>
 
    <a target="_system" href="https://stassociation.com/st/faq/"  class="col-md-12 menu-item">
      <i class="fa fa-external-link-square" aria-hidden="true"></i> FAQ
    </a>
 
    <a target="_system" href="https://stassociation.com/st/terms_of_use/"  class="col-md-12 menu-item">
      <i class="fa fa-external-link-square" aria-hidden="true"></i> Terms of use
    </a>
 
    <a target="_system" href="https://stassociation.com/st/consultation/"  class="col-md-12 menu-item">
      <i class="fa fa-external-link-square" aria-hidden="true"></i> Consultation
    </a>
 
    <a target="_system" href="https://stassociation.com/st/news/"  class="col-md-12 menu-item">
      <i class="fa fa-external-link-square" aria-hidden="true"></i> News
    </a>
 
    <a target="_system" href="https://stassociation.com/st/contacts/"  class="col-md-12 menu-item">
      <i class="fa fa-external-link-square" aria-hidden="true"></i> Contacts
    </a>

  </div>

    <div class="col-md-12  menu-item-close"><i class="fa fa-window-close" aria-hidden="true"></i> Close</div>
  </div>

<div class="head col-xs-12">
<div class="col-xs-2 open_menu"><i class="fa fa-list" aria-hidden="true"></i></div>
<img class="logo" src="http://sta.namgam.com/img/logo.svg">

<div class="col-xs-2 log_out pull-right"><i class="fa fa-sign-out" aria-hidden="true"></i></div>
</div>

 
   <div id="map" data-id="map" class="page"></div>
   <div class="map_menu set_markers"><i class="fa fa-map-marker" aria-hidden="true"></i></div>
   <div class="map_menu set_my_pos"><i class="fa fa-crosshairs" aria-hidden="true"></i></div>
   <div class="markers_menu">
     <div class="marker_list">

      <div data-id="1" data-name="bung" class="marker_icon"><img style="height: 80px"  src="http://sta.namgam.com/icon/bung.png"></div>
      <div data-id="2" data-name="traffic" class="marker_icon"><img style="height: 80px"  src="http://sta.namgam.com/icon/traffic.png"></div>
      <div data-id="3" data-name="accident" class="marker_icon"><img style="height: 80px"  src="http://sta.namgam.com/icon/accident.png"></div>
      <div data-id="4" data-name="police" class="marker_icon"><img style="height: 80px"  src="http://sta.namgam.com/icon/police.png"></div>
      <div data-id="5" data-name="rest" class="marker_icon"><img style="height: 80px"  src="http://sta.namgam.com/icon/rest.png"></div>
      <div data-id="6" data-name="weight" class="marker_icon"><img style="height: 80px"  src="http://sta.namgam.com/icon/weight.png"></div>
      <div data-id="7" data-name="close" class="marker_icon"><img style="height: 80px"  src="http://sta.namgam.com/icon/close.png"></div>
      <div data-id="8" data-name="rest_c" class="marker_icon"><img style="height: 80px"  src="http://sta.namgam.com/icon/rest_c.png"></div>
      <div data-id="9" data-name="weight_c" class="marker_icon"><img style="height: 80px"  src="http://sta.namgam.com/icon/weight_c.png"></div>

     </div>
   </div>

   <div data-id='menu1' class="page"></div>
   <div data-id='forum' class="page"></div>
   <div data-id='disp'  class="page"></div>
   <div data-id='radio' class="page"></div>
   <div data-id='add_thread' class="page"></div>
   <div data-id='support' class="page">
      <div class="col-md-12">
          <div class="col-md-12">
              <p class="mgt20">
              <b>Having problems?</b><br>
              let us know about them below and our support team will contact you and help resolve them as soon possible.
              </p>
              <div class="col-md-12 pad10">
                <div class="form-group">
                  <label>Whats on your mind?</label>
                  <textarea style="height:80px" id="woni" class="form-control"></textarea>
                </div>
                <div class="form-group">
                  <label>E-mail</label>
                  <input type="email" id="woni_id" class="form-control">
                </div>
                <div class="form-group">
                 <button id="woni_submit" class="btn btn-primary btn-block">Send</button>
                </div>
              </div>
          </div>

      </div>
   </div>
   <div data-id='login' class="page">
      <div class="col-xs-12 pad0">
            <div class=" col-xs-12 login_block">
             <h1>Login <span class="prem_key"></span></h1>
              <div class="col-xs-12 brd-t">
              <div class="form_error col-xs-12"></div>
                <div class=" form-group"> 
             <div class="input-group ">
             
               <input class="form-control auth_login" type="email" placeholder="Email address">
               <span class="input-group-addon"><i class="fa fa-envelope-o fa-fw"></i></span>
            </div>
            <br>
            <div class="input-group">              
              <input class="form-control auth_pass" type="password" placeholder="Password">
              <span class="input-group-addon"><i class="fa fa-key fa-fw"></i></span>
            </div>
            </div>
              <div class="form-group">              
                <button class="btn btn-primary btn-block send_auth">Login</button>
              </div>
            
            </div>
            </div>

            <div class="col-xs-12 user_data">
            <table class="table table-striped w100">
              <tr>
                <td><b><i>Welcome user:</i></b></td>
                <td class="user_name"></td>
              </tr>
              <tr>
                <td><b><i>Change status:</i></b></td>
                <td class="user_status">
                  <select  class="form-control change_status">
                    <option value="1">Driving</option>
                    <option value="2">Sleeping</option>
                    <option value="3">On duty</option>
                    <option value="5">Off duty</option>
                  </select>
                </td>
              </tr>
            </table>
                <div>
                    <div id="record" onclick="toggleRecording(this);">Запись</div>
                    </p>
                </div>

            </div>
      </div>
   </div>


   <div class="bottom_menu">
     <div class="col-xs-12 pad0">
        <div data-id='forum' class="bottom_menu_item col-xs-3 pad0">
          <i class="fa fa-comments" aria-hidden="true"></i><span> Forum</span>
        </div>
        <div data-id='menu1' class="bottom_menu_item col-xs-3  pad0  filter_log">
            <i class="fa fa-search" aria-hidden="true"></i><span>Find loads</span>
        </div>

     

        <div data-id='map' class="bottom_menu_item col-xs-3 pad0 ">
          <i class="fa fa-map" aria-hidden="true"></i><span>Map</span>
        </div>

        <div data-id='support' class="col-xs-3 pad0 bottom_menu_item"><i class="fa pad0 fa-support" aria-hidden="true"></i><span>support</span></div>
        
     </div>
   </div>

<div id="getorderModal" class="modal  fade " role="dialog">
        <div class="modal-dialog  modal-lg">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header mgb10">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Added load</h4>
                </div>
                <div class="container-fluid">
                   
                    <div class="col-md-12 form-group hidden">
                       Вы хотите взять заказ №: <span class="orderName"></span>
                    </div>
                     <div class="col-md-6 form-group">
                        <ul class="list-group">
                            <li class="list-group-item get_name"><b><i class="fa fa-user-circle-o" aria-hidden="true"></i> Name</b>: <span></span></li>
                            <li class="list-group-item get_phone"><b><i class="fa fa-phone-square" aria-hidden="true"></i> Phone</b>: <span></span></li>
                            <li class="list-group-item get_email"><b><i class="fa fa-envelope" aria-hidden="true"></i> Email</b>: <span></span></li>
                        </ul>
                    </div>
                    <div class="col-md-6 form-group">
                        <label>Leave comment for this company:</label>
                        <textarea class="form-control" name="commentOrder"></textarea>
                        <div class="col-md-12 form-group pad0 mgt10">


                            <button type="button" id="sendOrder" rel="" class="btn btn-info btn-block" >Send message</button>
                        </div>

                    </div>
                   

                  
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>

        </div>
    </div>

      <div class="radio_player">
      <div class="col-xs-2 radio_play_btn"><i class="fa fa-pause" aria-hidden="true"></i></div>
      <div class="col-xs-6 radio_name">RADIO DALNOBOISHIKOV</div>
       <div class="col-xs-2 radio_hide_btn"><i class="fa fa-times-circle" aria-hidden="true"></i></div>
       <div class="col-xs-2 radio_tray_btn"><i class="fa fa-minus-circle" aria-hidden="true"></i></div>
      <audio id="radio_player"   controls preload><source src="" type="audio/mpeg" /></audio>
      </div>
    <div class="loading">
        <div class="col-md-12">Loading...</div>
        <div class="col-md-12"><svg class="lds-blocks" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><rect x="19" y="19" width="20" height="20" fill="#df6018">
                    <animate attributeName="fill" values="#d64612;#df6018;#df6018" keyTimes="0;0.125;1" dur="1s" repeatCount="indefinite" begin="0s" calcMode="discrete"></animate>
                </rect><rect x="40" y="19" width="20" height="20" fill="#df6018">
                    <animate attributeName="fill" values="#d64612;#df6018;#df6018" keyTimes="0;0.125;1" dur="1s" repeatCount="indefinite" begin="0.125s" calcMode="discrete"></animate>
                </rect><rect x="61" y="19" width="20" height="20" fill="#df6018">
                    <animate attributeName="fill" values="#d64612;#df6018;#df6018" keyTimes="0;0.125;1" dur="1s" repeatCount="indefinite" begin="0.25s" calcMode="discrete"></animate>
                </rect><rect x="19" y="40" width="20" height="20" fill="#df6018">
                    <animate attributeName="fill" values="#d64612;#df6018;#df6018" keyTimes="0;0.125;1" dur="1s" repeatCount="indefinite" begin="0.875s" calcMode="discrete"></animate>
                </rect><rect x="61" y="40" width="20" height="20" fill="#df6018">
                    <animate attributeName="fill" values="#d64612;#df6018;#df6018" keyTimes="0;0.125;1" dur="1s" repeatCount="indefinite" begin="0.375s" calcMode="discrete"></animate>
                </rect><rect x="19" y="61" width="20" height="20" fill="#df6018">
                    <animate attributeName="fill" values="#d64612;#df6018;#df6018" keyTimes="0;0.125;1" dur="1s" repeatCount="indefinite" begin="0.75s" calcMode="discrete"></animate>
                </rect><rect x="40" y="61" width="20" height="20" fill="#df6018">
                    <animate attributeName="fill" values="#d64612;#df6018;#df6018" keyTimes="0;0.125;1" dur="1s" repeatCount="indefinite" begin="0.625s" calcMode="discrete"></animate>
                </rect><rect x="61" y="61" width="20" height="20" fill="#df6018">
                    <animate attributeName="fill" values="#d64612;#df6018;#df6018" keyTimes="0;0.125;1" dur="1s" repeatCount="indefinite" begin="0.5s" calcMode="discrete"></animate>
                </rect></svg></div>
    </div>

dio/mpeg" /></audio>
    </body>
</html>